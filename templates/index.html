<!-- <!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, user-scalable=no" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <title>Drawing tools</title>
        <style>
            body {
                margin: 0;
            }
            canvas {
                border: 2px solid black;
            }
        </style>
    </head>
    <body>
        <div class="col-md-6 ">
           <canvas id="canvas" width="280" height="280" style="border:4px solid black;margin:5%;"></canvas>   
           <div class="btns ml-4">
                <button class="btn btn-success" onclick="UploadPic();return false;">Predict</button>
                <button class="btn btn-danger" onclick="erase();return false;">Reset</button>
           </div>              
       </div>

        <div id="result" class="alert alert-success" style="display:none">
            Looks like, You have entered a : <strong id="pred"></strong> with probability of <strong id="prob"></strong>
        </div>

    </body>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <script>

        function erase() {
            var canvas, ctx, flag = false;
            canvas = document.getElementById('canvas');
            ctx = canvas.getContext("2d");
            w = canvas.width;
            h = canvas.height;
            ctx.clearRect(0, 0, w, h);
            document.getElementById("result").style.display = "none"

        }

        // Brush colour and size
        const colour = "#000000";
        const strokeWidth = 25;

        // Drawing state
        let latestPoint;
        let drawing = false;

        // Set up our drawing context
        const canvas = document.getElementById("canvas");
        const context = canvas.getContext("2d");

        // Drawing functions

        const continueStroke = newPoint => {
            context.beginPath();
            context.moveTo(latestPoint[0], latestPoint[1]);
            context.strokeStyle = colour;
            context.lineWidth = strokeWidth;
            context.lineCap = "round";
            context.lineJoin = "round";
            context.lineTo(newPoint[0], newPoint[1]);
            context.stroke();

            latestPoint = newPoint;
        };

        // Event helpers

        const startStroke = point => {
            drawing = true;
            latestPoint = point;
        };

        const BUTTON = 0b01;
        const mouseButtonIsDown = buttons => (BUTTON & buttons) === BUTTON;

        // Event handlers

        const mouseMove = evt => {
            if (!drawing) {
                return;
            }
            continueStroke([evt.offsetX, evt.offsetY]);
        };

        const mouseDown = evt => {
            if (drawing) {
                return;
            }
            evt.preventDefault();
            canvas.addEventListener("mousemove", mouseMove, false);
            startStroke([evt.offsetX, evt.offsetY]);
        };

        const mouseEnter = evt => {
            if (!mouseButtonIsDown(evt.buttons) || drawing) {
                return;
            }
            mouseDown(evt);
        };

        const endStroke = evt => {
            if (!drawing) {
                return;
            }
            drawing = false;
            evt.currentTarget.removeEventListener("mousemove", mouseMove, false);
        };

        // Register event handlers

        canvas.addEventListener("mousedown", mouseDown, false);
        canvas.addEventListener("mouseup", endStroke, false);
        canvas.addEventListener("mouseout", endStroke, false);
        canvas.addEventListener("mouseenter", mouseEnter, false);

        // $(document).ready(function(){
        //     $("#btn").click(function(event){
        //         // alert('haha');
        //         var $SCRIPT_ROOT = '{{ request.script_root|tojson|safe }}';
        //         var canvasObj = document.getElementById("canvas");
        //         var img = canvasObj.toDataURL();
        //         $.ajax({
        //             type: "POST",
        //             url : $SCRIPT_ROOT + "/predict/",
        //             data : img,
        //             success : function(data){
        //                 $('#result').text(' Predicted Output: ' + data);
        //             }
        //         });
                

        //     });
        // });

        function UploadPic() {
           // Generate the image data
           console.log('hahahah');
           var Pic = document.getElementById("canvas").toDataURL("image/png");
           Pic = Pic.replace(/^data:image\/(png|jpg);base64,/, "")
           // Sending the image data to Server
           $.ajax({
               type: 'POST',
               url: '/predict',
               data: JSON.stringify({ image : Pic }),
               contentType: 'application/json;charset=UTF-8',
               dataType: 'json',
               success: function(msg,status, jqXHR){
                     var a = JSON.parse(jqXHR.responseText);
                     var prediction = a.prediction;
                     var prob = msg.probability
                     
                     document.getElementById("pred").innerHTML = prediction
                     document.getElementById("prob").innerHTML = prob
                     document.getElementById("result").style.display = "inline"

               }
           });
       }
        
    </script>

</html> -->

<html>
	<head>
		<meta name="csrf-token" content="csrf-token">
   </head>
   <body onload="init();">
        <canvas id="myCanvas" width="280" height="280" style="border:4px solid black;margin:5%;"></canvas>	
        <div>
            <button class="btn btn-success" onclick="javascript:UploadPic();return false;">Predict</button>
            <button class="btn btn-danger" onclick="javascript:clearArea();return false;">Reset</button>
        </div>			   
        <div id="result" class="alert alert-success" style="display:none">
            Predicting : <strong id="pred"></strong> with probability of <strong id="prob"></strong>
        </div>
		   
	   <script src="../static/js/jquery-3.4.0.min.js" type="text/javascript"></script>
	   <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
	   <script src="../static/js/bootstrap.min.js"></script>
	   <script src="../static/js/index.js"></script>
	</body>
</html>